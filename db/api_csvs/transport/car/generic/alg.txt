//throws an error if country undeclared
try { 
  var c=country;
}
catch(err){
  country='';
}
// if car's country value isn't set, get country
// from metadata
if (country == ''){
  country = profileFinder.getProfileItemValue('metadata', 'country');
}

if ((country == null) || (country == '')) {
	country = 'United Kingdom';
}

//Get the fuel factor, kgCO2 per litre
if(fuel=='diesel'){
fuelFac = dataFinder.getDataItemValue('home/energy/quantity', 
'type=diesel', 'kgCO2PerLitre');
}
else {
fuelFac = dataFinder.getDataItemValue('home/energy/quantity', 
'type=petrol', 'kgCO2PerLitre');
}

// now calculate the monthly kgCO2 emissions
fac=0.;
if(kmPerLitreOwn!=null && kmPerLitreOwn>0){
    fac=fuelFac/kmPerLitreOwn;
}
else if(kmPerLitre!=null && kmPerLitre>0){
    fac=1.15*fuelFac/kmPerLitre;
}
else if (country == 'United States' || country == 'Canada'
|| country == 'US' || country == 'CA') {
    fac = 1.15*kgCO2PerKmUS;
} else {
    fac= 1.15*kgCO2PerKm;
}
if(occupants>0)
    fac * distanceKmPerMonth/occupants;
else
    fac * distanceKmPerMonth;
